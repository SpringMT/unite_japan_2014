# Untie Japan
## 一日目
### 基調講演
オキュラスの人がきてる
コラボレーションが重要
OSSみたいな感じかな、一緒になって作業する
2005かー 結構前だなあ
分業
コラボレーションのツール = unity
実際の規模 
UFPS
5000DL × $20
Asset Store : 2 week位の工数減る
2000億円のsaving

Largest ever Marketplace

Prime - time TV
100M pepole -> 高い

App market
 2B people now
 5B people soon
 
 50x growth in 20 years

爆発的に伸びる、競争激化

課題
オーディエンスとのつながり
EveryPlay -> Unityの中に取り込む

EveryPlayの話
どうやってゲームを見つけるか
 -> その場で画面見せるんじゃないか
調査した -> 友人に見せてもらったが多い
game video
口コミから広がる
Every Playのデモ

ビデオで録画 -> share FBとかで
二分で統合できる

#### unity5の新機能
グラフィックス機能の強化
物理ベースシェーディング
universal sharder
今まではshaderの組み合わせが必要
 -> 一個のshaderのみOK

reflection probe でリアルタイムの反射

リアルタイムグローバルイルミネーション
二次反射、三次反射を表現
光源を動かしたりもできる

OpenRLで組み合わせることで、グローバルイルミネーションを数秒で反映される

リアルタイムレイトレーシング、これの変更が3秒くらいで出来る。いままでは10分、1時間、一晩すらあったのに。これはアーティスト=サンにとってとてもすごい #unitej

PBRについて。Universal Shader。リフレクションプローブによる反射表現。リアルタイムG.I.、Enlighten、OpenRL （エディター機能）。 ( #unitej live at ustre.am/1bKAN)

質感とパラメータが直感的に操作できる

イメージベースドライティング
image-based lighting
背景との一致

グラフィックス以外
WebGL


#### ここで戻る
新しい機能

multi scene ediiting
複数のシーンを作業かのう
マルチシーン編集。複数のシーンを同時に編集できる。 #unitej


SceneManger
levelの管理が簡単になる
やっとシーン遷移マネージャAPIが出来るのか #unitej

Multi player networing
infra ホスティングもする
Transport Layer
Low Level API client/sever model
HighLevelAPI
Mach Macer
ReLay Server 

Asset bundleの話聞きたくなってきた

まとめへ
何が次にくるのか、
virtual realityが次にくるのでは
オキュラス
SAO
リアル以上の体験
お金がなくてもテクノロジーが手に入る
VRにようやく大手が注目する時代がきた。偶然では無い。なぜならテクノロジーの準備ができたから。小型モーションセンサー、高解像度、レンダリングパワー。レンダリング技術。 #unitej
技術の躍進
グラフィックスは多少は良くなってますよwwww

ゲームはハードウェアの限界を追求してきた。2Dができるなら2D、3Dができるなら3D追加。高解像度などやってきたが、進歩のテンポが落ちてきてしまった。ここでVRが突破口になると考える。 #unitej

軍事用のVRとかSAOやん。。。

VRに必要なもの inputデバイス
Latencyが問題
FRが下がる
VRはいろいろな処理があってレイテンシーがやばい。レイテンシーが低いと酔ってしまう。DK2は90hz（っていってたかな？ #unitej
60fpsは最低ライン、商社向けVRは90Hz! #unitej #OculusRift

ゲームの移植大変 -> ほぼほぼ不可能

VRはどーるどラッシュみたいにすぐに入っていけない
VRは最初からかんがえて作らないといれられない

日本でのコンテンツが一番、最初からVRを前提として作ったものが多い。海外だとまず移植から考える人が多い #unitej

Oculas japanの設置
DK2


## スクエニの話
プログラマー編
c++ からc#へのコンバート
コンバートツールの作成
ざっくりと変換 -> 少しは手作業

コメントアウト -> ビルド通す -> コメントアウト外す
GCがおおいので、作りなおし


マルチUV
シェーダー
4600子のシェーダー
batchで作っている
-> カクつく -> 先読みで対処

また、複数の機能のブレンドを1つのシェーダーにまとめたりして数を減らした。 #unitej
数がありすぎて、マテリアルインスペクターから選択が不可能。さらに問題はシェーダーコンパイルがランタイム随時なのでカクツキがめだつ。よく利用するシェーダーをまとめて先読みして処理した。 #unitej

### ゲームデザイン編
片手で遊びやすく

ボタンがないイライラ感の解消
-> 画面を見ただけで判断できるように変更

オート会話機能
 近づいて止まるだけで会話開始
 近づく -> 話を聞きたいと追うこと
 
親指が届く範囲(下半分に)にボタンは設置

ビルドサイクル
日々の作業がじかんかかる
SSDのっければ早くなる
お金で解決

RayCastの拡張してる。
RayCastを飛ばして、あたったら更にRayCastを飛ばすという拡張
数百回のRayを飛ばすこともある

マップではUnityの当たり判定で受けてからPS2の処理に渡してやることで、コリジョン抜けをしないようにしたとか。ヒットした座標からレイを飛ばしてやるため冗長に。 pic.twitter.com/fPQvnuURdL
ということで重くなったので、プレイヤーにだけ適用して、村人などはUnity判定のみとした #unitej

Unityの当たり判定は「一番近いポリゴン」なんですが、オリジナル版では属性があり、近いけど無視する　みたいなのを実現する必要がありました #unitej

移植のポイント
１つ目ですが、Unityで移植するべきかの判断です。過去資産とUnityとの相性を調べましょう。もっとも大きな壁として言語の壁があります。 #unitej
GCとかの問題

Unityで移植を成功させるには。まずUnityで移植するべきかどうか。過去資産との相性。言語の壁。どうやって移すか。メモリ管理が異なることによるパフォーマンス。メモリ不足など考慮。 #unitej

中断セーブ可能な作りかどうか -> 移植できるかのおおきなポイント

動作スペックの定義
３番目は最適化済みデータです。最終的には1.7GBになりましたが、インストールには倍ぐらいの空き容量が必要 #unitej

全てを再現しない


キャッシュはかなり限られてる(最大でも200MB) -> キャッシュの活用場所を考える

ロード＆レスポンス。使用できるメモリが少ないので、メモリに載せるデータをよく考えること。また、ロードレスポンスのためにはキャッシュをうまく使う。シェーダーの例もその1ぶ。 #unitej

## Asset Storeの話
* SkyShop unity5で付く 4でも使える
* RobotWarrior2
* Nugget
* Shader Forge
	* strumply shafer editor 
* Tread Ninja
	* スレッドらいくなコルーチン
	* 別スレッド
	* Spicy Pixelが似たAssets
	ランタイムのシーンマネージャー。LoadLevelAdditiveでは読んだものをアンロードしたい場合に、どれがそうだったか区別できるようにしておく仕組みがひつようだった。そうしないで良いような感じ。（かな？ #unitej

* Aoi chan
* 2D Terrain Editor
* Ferr2D Ferr2DTerrain
* Easy Masking Transition
* UniMerge
* Asset Store tools


## maya
Atom to bit
リアリティキャプテャ
現実世界でのBRDF SOC200

フィギュアを元にデータ化してゲームに使っていこうというセッション。DFから借りたエクスマキナのキャラフィギュアから。 #unitej

3Dレーざースキャナに

Autodesk ReCap -> これはwebサービス creditかかる  １回700円位

*コツがあるのか。。。

Maya LTを通さないとunityでは使えない

141枚のPhotoを

AutoDeckRecapのコツ
十足
* 三脚を使うべし(シャッタースピードを落とす必要がある)
* 特徴点を作る あとでphotoshopで消す。。。。
	ReCap で綺麗に取るコツのひとつはシールを貼ったりマーカで印をつけたりして特徴点を増やすこと。余計なマーカは後で Photoshop で編集すればおｋ、ただテクスチャがまたがると修正は大変 #unitej

* マニュアル操作にして数値固定
* リモコンシャッター使う
* 屋内で撮影する
	* 123dキャッチ
* 証明からスタート
* LightRoom使う

超解像度のメッシュの課題

* メッシュのリファイン
* パフォーマンス
* Meshの結合
UVの調整
超解像度メッシュができあがるまでの課題。130万フェイスを超える。 #unitej pic.twitter.com/ruJWPgyG2L


MechMixer Freeで使える

UV

MayaLTでsend to Unity
ハイメッシュすぎる -> ローメッシュにして かつ ボーンも入れる
Simplygon unity
Collada Exporter unityの世界からMayaLTの世界へ移れる
Mixianoでボーンを入れる


SendToUnityをつかってハイメッシュをUnityの頂点制限に合わせて分割して送ってから、ローポリに変換して、Colladaにして出して、MayaLTで合成してUnityへ出してって行ったり来たりすごいなw #unitej pic.twitter.com/a5bWpwlQJu

ReCap -> meshmixer でリファイン -> Maya LT で UV 調整 -> Unity で Simplygon でポリゴン削減 -> Collada Exporter -> Maya LT で 1メッシュ -> Unity -> Mixamo #unitej

## Klabのセッション
ユーザーの要望にそって開発している
SpriteStudio
SmootheMoves

SpriteStudio

* スクリプトでアニメーションの制御


* SSPlyaerの改造
	フィーバー中のTime.scale = 0fだとSSPlyaerもとまってしまう
Time.TimeScaleは便利だけど、止まってほしくないものも止まっちゃうから難しいですよね　#unitej

#### クリエイターの人の話
ドローコール多い
アニメーションを配置しすぎると、ドローコル増える

同Z軸にアニメーションを配置しない

エリアを分けて配置して表示する

EasyGUI

ミリオンアーサーSpriteStudio使ってたのか #unitej
Vita版ミリアサのおっぱいたゆんたゆんはSpriteStudioでつけたアニメーションです(重要 #unitej

PocoTown
クライアント側でアバターの服装変えたらサーバ側でアトラス生成して返してくれるって凄いな～ ( #unitej live at ustre.am/1bKAN)

メルクストーリア

SpriteStudio 5.3からムービークリップ的な元パーツとインスタンスパーツの機能が入ったらしい #unitej


## androidの発表
すげーな 32年か。。。。俺のとしと一緒やんけ

アンドリューさん。32年前からコンソールプログラマー。ここ数年はAndroidのゲームをつくってます。iOSはぷろびじょにんぐがひどくてあんまりやる気しない #unitej

Unitron

google playで見れる

物理コライダー
physicsコライダー

retinaがあれば、座標で表現できる
フィルターはなるべくしない、

特定の端末でまずいばあいは、特定の端末だけ公開しないようにできたりする。またマルチタッチが必要かどうかなどハード的な要件でオンオフできる。 #unitej
ただ、上記のことはオススメしない

Android Manifestはイジる必要は殆ど無い
上書きできるので、方法は写真
マニフェストは通常Unityが自動でやるから何もしなくて良いが、一部のアセットを使いたい場合は自分で対応しないとならないこともある。 #unitej

古いandroidを使っている場合、
android versionはunityにお任せしたほうがよい
アーティストにPhotoshopでのモックアップを作ってもらわない方が良い。そうすると特定の解像度に依存してしまう。UnityEditorで作ってもらう方が良い #unitej

pixel perfect
Unity Editor内でやってもらう

uGUI 4.5 4.6

スクリーン縦横比。3Dの場合は短い幅を合わせて調整すると良い。2Dの場合は長い方を合わせてやると良い場合もあるかも。 #unitej pic.twitter.com/MlKHgsgD3J

スクリーンサイズ。RawPixelについては気にしないこと。PixelPerfectはコンソールではやるがモバイルでは考えない方が良い。もしやろうとするとものすごい数の解像度に対応しないといけない #unitej

ゲーム画面の形状を帰ることで対応する。自動的にゲームの配置を行う場合は使えるでしょう。サッカーのピッチでも微妙に場所によってサイズが違うのでOKでしょ。 #unitej pic.twitter.com/GaksHxwxxx

ということでピクセルで考えてはいけない。数式で対応するべき。 #unitej
mで計算とかする。計算しろってことだな

さっきのばあいはゲームエリアが面積が等しいように調整してやれば問題ないということもあると。 #unitej

パフォーマンス最適化
自分でよめだと。。。

パフォーマンス最適化。モバイル用の最適化についての他の情報を参照するのが良い。 #unitej

プロファイラをみるポイント -> 基本的に
プロファイル。Pro版の機能。プロファイらを起動して、WifiかUSBで接続して使う。（あ、それだけか #unitej

圧縮Textureを使うと、
テクスチャフォーマット。圧縮テクスチャはサイズも大きいし描画も遅い。圧縮すると2倍速く描画できる。 #unitej
レンダリングパス。FowardRenderingよりもVertexLitの方が早いので見た目に問題なければそっちを使うと良いってことかな #unitej

オーディオの圧縮はあまりオススメしない
メモリーに乗っけておく
オーディオの圧縮はお勧めできない。圧縮するとCPUが使われる。（これはCRIつかったら良いのかもね #unitej
3Dオーディオが必要ない場合はOFFにすると40％はやくなった #unitej

NativeRenderingPlugin。レンダリング時にコールバックをうけられる。パフォーマンスのために苦労を惜しまないひとのための措置とのこと。Unity4.5にて。 #unitej

Unityを使えばAndroid NDKを使う時にJNIは不要。 #unitej


# Mecanim
unity5で使える機能の紹介
Entryノード exitノード
statemachineにロジックが付けれる

StateMachineBehaviour には、OnStateEnter / OnStateUpdate / OnStateExit / OnStateMove / OnStateIK がいる。ここからステートマシンを制御して活き活きとしたアニメーションが出来る。#unitej



behaviroeのコールバックで色々visualのフィードバックをついかできる
ビヘイビアのコールバックを使うことで必要な際にエフェクトを追加したりできる。モーションにつけなくてもビヘイビアのコードで指定してあげれば良い #unitej


アニメーションは相対一で動くようにする
generate root motion
全てスクリうとからコントロールできる

前に進ませたいアニメーションを作りたい場合に、通常は絶対値ではいるのでずっと進むモーションは作れないが、RooMotionを使うとずっと進むように作れる。 #unitej

メカニムをスクリプトで生成できるようになった。スプライトのアニメーションが流用可能ではなかった、のでスクリプトで生成するのに向いている（のかな？ #unitej

AssetCreationAPIを使うと、アニメーションを生成して、ステートマシンとトランジションの生成がすべてできるようになった。 #unitej

Unity5 Mecanimがかなり良さげ。StateMachine behaviorでアニメーションにcallbackを指定できるから、かなりカスタマイズが楽になる。  #unitej

MecanimのBlend treeも機能強化された模様で、たとえばmixしたプレビューの向きが自由に変えられるようになった  #unitej

顔のアニメーション。DirectBlendTreeを使うと好きなブレンドをコントロールできる。これでステートでブレンドをコントロールしてスコアに応じて笑顔になるとかをやれる。 #unitej

ステートマシンの遷移（Entry / Exit ノードの追加）、ステートマシンの Behaviour による制御、Asset Creation API でオーサリング修正など、ブレンドツリー強化、ルートモーションを独自でオーサリング、ダイレクトブレンドツリーの追加 #unitej

Q；キャラの制御がAnimator以外のコントロールが必要になる。AIは別のステートマシンでやっていた。こういう場合に他とやりとりできない。Animatorにランライムのデバッガを追加して監視したり、他のステートを参照できるようになったりしないか？ #unitej

A；ビヘイビアツリーとメカニムのステートとの同期が難しいということですか？どちらかをマスターになるかを決めないといけない。あるステートに入ったらビヘイビアツリーを矯正することができる。逆も可能。 #unitej
Play のかんすうをつかえばビヘイビア側からメカニムのステートをセットできる。 #unitej

Animator自体はカスタマイズできないっぽいな。API公開についてはEditor側の話でランタイムとは関係ないと #unitej

Q：今回の話でプロ版のみなどの限定的なものはあるか？A；まだ決めていない。 #unitej




### メモ
モデル複数が1つのマテリアルを共有しているとき、依存性処理のために依存性チェーンを作りながら、適切な順序でアセットバンドルを作っていかないとならない。そういう注意深いコードが必要となる #unitej

ランタイムのシーンマネージャー。LoadLevelAdditiveでは読んだものをアンロードしたい場合に、どれがそうだったか区別できるようにしておく仕組みがひつようだった。そうしないで良いような感じ。（かな？ #unitej

APIでも同じように、AdditiveのロードとUnloadがシーン名を引数にコールできる。ランタイムではUnloadしてもヒエラルキーからシーン名自体は消えない。（オブジェクトはアンロードされるが、シーン自体はのこる？キャッシュなのかな？ #unitej

Q；シーン内のライトマップ、ナビメッシュについてどうなるか。いままではLoadSceneAdditiveでは失敗していたが。A；5ではライトマップとオクルージョンカリングは自動で対応される（？どういうことなんだろ）ナビメッシュはすべてを参照するかもしれない #unitej











